<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OC World - Discord Community Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400&family=Nunito:wght@300;400;600;700&family=Pacifico&family=Lilita+One&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Neon Theme Defaults */
            --primary-bg-color: #0a0f18; --secondary-bg-color: #1a1f2b;
            --accent-color: #00ffff; --glow-color: #00ffff80;
            --text-color: #e0e0e0; --heading-color: #ffffff; /* General heading color for neon */
            --border-color: #00ffff50; --particle-color: "#00ffff";
            --particle-line-color: "#00ffff"; --main-title-font: 'Orbitron', sans-serif;
            --header-font: 'Orbitron', sans-serif; --body-font: 'Roboto', sans-serif;
            --transition-speed: 0.3s;
        }

        body.theme-neon.mode-light { /* Neon Light definitions */
            --primary-bg-color: #e0e5f0; --secondary-bg-color: #f0f5ff;
            --accent-color: #007bff; --glow-color: #007bff80;
            --text-color: #333740; --heading-color: #050a14;
            --border-color: #007bff50; --particle-color: "#007bff";
            --particle-line-color: "#007bff";
        }

        body.theme-pink {
            --main-title-font: 'Lilita One', cursive;
            --header-font: 'Pacifico', cursive;
            --body-font: 'Nunito', sans-serif;
        }

        body.theme-pink.mode-dark {
            --primary-bg-color: #59394f; --secondary-bg-color: #6e4960;
            --accent-color: #ff9cc8;
            --glow-color: #ff9cc830; --text-color: #f8eaf0;
            --heading-color-general-pink: #ffffff;
            --border-color: #ff9cc820;
            --particle-color: "#ff9cc8"; --particle-sparkle-color: "#fce4ec";
            --button-bg-color: #ff9cc8; --button-text-color: #4a2a40;
            --hover-button-bg-color: #ffb3d7;
            --placeholder-bg-dots: rgba(255,255,255,0.07);
            --main-title-oc-color: #ff85a2; --main-title-world-color: #ffb380;
            --main-title-discord-color: #bca0dc; --main-title-community-color: #ffd980;
            --main-title-hub-color: #80d0c7;
            --heading-color-lavender: #d1b3e6; --heading-color-peach: #ffcc99;
            --heading-color-mint: #a3e6e1;
            --main-title-shadow-dark: 1px 1px 0px #402937, 2px 2px 0px #402937;
        }

        body.theme-pink.mode-light {
            --primary-bg-color: #fff5f8; --secondary-bg-color: #ffe6f0;
            --accent-color: #ff7bac;
            --glow-color: #ff7bac30; --text-color: #6d4b5d;
            --heading-color-general-pink: #c74474;
            --border-color: #ff7bac20;
            --particle-color: "#ff7bac"; --particle-sparkle-color: "#ffc1d9";
            --button-bg-color: #ff7bac; --button-text-color: #fff0f8;
            --hover-button-bg-color: #ff99c2;
            --placeholder-bg-dots: rgba(221, 105, 159, 0.1);
            --main-title-oc-color: #ff6392; --main-title-world-color: #ffab73;
            --main-title-discord-color: #ad86d9; --main-title-community-color: #ffe082;
            --main-title-hub-color: #66cdaa;
            --heading-color-lavender: #c59ee0; --heading-color-peach: #ffc68a;
            --heading-color-mint: #7fdbc5;
            --main-title-shadow-light: 1px 1px 0px #f8d7e7, 2px 2px 0px #f8d7e7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: var(--body-font); background-color: var(--primary-bg-color);
            color: var(--text-color); line-height: 1.6; overflow-x: hidden;
            position: relative;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }
        #particles-js { position: fixed; width: 100%; height: 100%; background-color: transparent; z-index: -1; }

        .site-header {
            background-color: color-mix(in srgb, var(--secondary-bg-color) 80%, transparent);
            padding: 15px 20px; border-bottom: 2px solid var(--accent-color);
            box-shadow: 0 3px 10px var(--glow-color); position: relative; z-index: 10;
            display: flex; justify-content: space-between; align-items: center;
            flex-wrap: wrap;
            transition: all var(--transition-speed) ease;
        }
        body.theme-pink .site-header {
            border-radius: 0 0 25px 25px; border-bottom-width: 3px;
            padding: 20px 25px;
        }

        .header-main-content { display: flex; flex-direction: column; align-items: flex-start; flex-grow: 1; }
        .logo-title-container { display: flex; align-items: center; gap: 15px; margin-bottom: 5px; }
        .server-logo {
            width: 55px; height: 55px; border-radius: 50%;
            border: 3px solid var(--accent-color);
            box-shadow: 0 0 8px var(--glow-color); background-color: var(--secondary-bg-color);
            object-fit: cover; transition: all var(--transition-speed) ease;
        }
        body.theme-pink .server-logo {
            border-color: white; box-shadow: 0 0 0 3px var(--accent-color), 0 0 10px var(--glow-color);
            padding: 2px; background-clip: content-box;
        }

        .site-header h1 {
            font-family: var(--main-title-font);
            font-size: 2.2em; transition: all var(--transition-speed) ease;
            text-align: left; line-height: 1.1; display: flex; flex-wrap: wrap;
            align-items: baseline; gap: 0.2em;
        }
        body.theme-neon .site-header h1 {
            color: var(--heading-color); text-shadow: 0 0 5px var(--accent-color), 0 0 10px var(--accent-color);
            letter-spacing: 2px;
        }
        body.theme-pink .site-header h1 { font-size: 2.6em; font-weight: normal; }
        body.theme-pink .site-header h1 .title-word {
            display: inline-block; text-shadow: var(--main-title-shadow-light); padding: 0 0.05em;
        }
        body.theme-pink.mode-dark .site-header h1 .title-word { text-shadow: var(--main-title-shadow-dark); }
        body.theme-pink .site-header h1 .title-oc { color: var(--main-title-oc-color); }
        body.theme-pink .site-header h1 .title-world { color: var(--main-title-world-color); }
        body.theme-pink .site-header h1 .title-discord { color: var(--main-title-discord-color); }
        body.theme-pink .site-header h1 .title-community { color: var(--main-title-community-color); }
        body.theme-pink .site-header h1 .title-hub { color: var(--main-title-hub-color); }

        .header-main-content .design-note {
            font-size: 0.8em; color: var(--accent-color); font-style: italic;
            margin-left: 70px; transition: color var(--transition-speed) ease;
        }
        body.theme-pink .header-main-content .design-note {
            font-family: 'Nunito', sans-serif; font-weight: 600;
            color: var(--text-color); margin-top: 0px;
        }
        
        .header-controls-container {
            display: flex; align-items: center;
            gap: 15px; margin-left: auto;
        }
        .theme-controls { display: flex; align-items: center; gap: 10px; }
        .theme-controls button, .theme-controls .theme-label {
            background: none; border: 1px solid var(--accent-color); color: var(--accent-color);
            padding: 6px 12px; border-radius: 8px; cursor: pointer; font-family: inherit; font-size: 0.9em;
            transition: all 0.2s ease;
        }
        .theme-controls .theme-label { border: none; padding-right: 0; font-weight: 600; }
        .theme-controls button:hover {
            background-color: var(--accent-color);
            color: var(--button-text-color, var(--primary-bg-color));
            transform: translateY(-1px) scale(1.05);
        }
         .theme-controls button.active {
            background-color: var(--accent-color);
            color: var(--button-text-color, var(--primary-bg-color));
            box-shadow: 0 0 8px var(--glow-color); transform: scale(1.05);
        }
        body.theme-pink .theme-controls button {
            font-family: 'Nunito', sans-serif; font-weight: 700; border-width: 2px; border-radius: 20px;
            background-color: var(--button-bg-color); color: var(--button-text-color);
            border-color: color-mix(in srgb, var(--accent-color) 50%, white 50%);
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }
        body.theme-pink .theme-controls button:hover, body.theme-pink .theme-controls button.active {
             background-color: var(--hover-button-bg-color);
             box-shadow: 0 2px 6px var(--glow-color), inset 0 1px 2px rgba(255,255,255,0.3);
        }
        .mode-toggle { font-size: 1.2em !important; }

        .site-header-actions {}
        .chat-icon-link {
            display: flex; align-items: center; gap: 5px; padding: 6px 10px;
            border-radius: 20px; text-decoration: none; color: var(--accent-color);
            border: 2px solid var(--accent-color);
            font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 0.9em;
            transition: all 0.2s ease;
        }
        .chat-icon-link svg { fill: var(--accent-color); transition: fill 0.2s ease; }
        .chat-icon-link:hover {
            background-color: var(--accent-color);
            color: var(--button-text-color, var(--primary-bg-color));
            box-shadow: 0 2px 6px var(--glow-color); transform: translateY(-1px);
        }
        .chat-icon-link:hover svg { fill: var(--button-text-color, var(--primary-bg-color)); }

        body.theme-pink .chat-icon-link {
            color: var(--button-text-color); background-color: var(--button-bg-color);
            border-color: color-mix(in srgb, var(--accent-color) 50%, white 50%);
        }
        body.theme-pink .chat-icon-link svg { fill: var(--button-text-color); }
        body.theme-pink .chat-icon-link:hover {
            background-color: var(--hover-button-bg-color); color: var(--button-text-color);
        }
        body.theme-pink .chat-icon-link:hover svg { fill: var(--button-text-color); }

        .marquee-container {
            background-color: var(--secondary-bg-color); color: var(--accent-color); padding: 10px 0;
            font-size: 1.1em; font-weight: bold; border-bottom: 1px solid var(--border-color);
            position: relative; z-index: 9; text-shadow: 0 0 3px var(--accent-color);
            overflow: hidden; transition: all var(--transition-speed) ease;
        }
        body.theme-pink .marquee-container {
            border-radius: 15px; margin: 15px 20px 5px;
            box-shadow: 0 3px 8px var(--glow-color), inset 0 0 5px color-mix(in srgb, var(--primary-bg-color) 20%, transparent);
            text-shadow: 1px 1px 0px color-mix(in srgb, var(--primary-bg-color) 30%, transparent);
            font-family: 'Nunito', sans-serif; font-weight: 700; padding: 12px 0;
            border: 2px solid color-mix(in srgb, var(--accent-color) 50%, white 50%);
        }
        .marquee-container marquee { display: block; }

        .main-container {
            display: flex; max-width: 1400px; margin: 20px auto;
            padding: 0 20px; gap: 20px; position: relative; z-index: 5;
        }
        body.theme-pink .main-container { gap: 25px; }

        .sidebar {
            flex: 0 0 320px; align-self: flex-start;
            background-color: var(--secondary-bg-color); padding: 25px;
            border-radius: 8px; border: 1px solid var(--border-color);
            box-shadow: 0 0 10px var(--glow-color);
            transition: all var(--transition-speed) ease;
        }
        .content-area {
            flex-grow: 1;
            background-color: var(--secondary-bg-color); padding: 25px;
            border-radius: 8px; border: 1px solid var(--border-color);
            box-shadow: 0 0 10px var(--glow-color);
            transition: all var(--transition-speed) ease;
        }

        body.theme-neon .sidebar, body.theme-neon .content-area {
             background-color: color-mix(in srgb, var(--secondary-bg-color) 85%, transparent);
        }
        
        body.theme-pink .sidebar, body.theme-pink .content-area {
            border-radius: 20px; border-width: 2px; padding: 30px;
            border-color: color-mix(in srgb, var(--accent-color) 25%, white 75%);
            box-shadow: 0 5px 15px var(--glow-color), inset 0 0 15px color-mix(in srgb, var(--primary-bg-color) 20%, transparent);
        }

        .sidebar h2, .content-section .content-section-title {
            font-family: var(--header-font); margin-bottom: 25px; text-align: center;
            border-bottom: 1px solid var(--border-color); padding-bottom: 10px;
            transition: all var(--transition-speed) ease;
        }
        body.theme-neon .sidebar h2, body.theme-neon .content-section .content-section-title {
            color: var(--accent-color); text-shadow: 0 0 3px var(--accent-color); font-size: 1.8em;
        }
        
        body.theme-pink .sidebar h2,
        body.theme-pink .content-section .content-section-title {
            font-size: 2.2em; padding-bottom: 15px;
            text-shadow: 1px 1px 0px color-mix(in srgb, var(--primary-bg-color) 40%, transparent), 0 0 5px var(--glow-color);
            border-bottom-width: 2px;
            border-image: linear-gradient(to right, transparent 0%, var(--accent-color) 30%, color-mix(in srgb, var(--accent-color) 50%, white 50%) 50%, var(--accent-color) 70%, transparent 100%) 1;
        }
        body.theme-pink .sidebar h2 { 
            color: var(--heading-color-lavender);
            border-image-source: linear-gradient(to right, transparent 0%, var(--heading-color-lavender) 30%, color-mix(in srgb, var(--heading-color-lavender) 50%, white 50%) 50%, var(--heading-color-lavender) 70%, transparent 100%);
        }
        body.theme-pink #about-server .content-section-title { 
            color: var(--heading-color-peach);
            border-image-source: linear-gradient(to right, transparent 0%, var(--heading-color-peach) 30%, color-mix(in srgb, var(--heading-color-peach) 50%, white 50%) 50%, var(--heading-color-peach) 70%, transparent 100%);
        }
        
        #user-list-container { display: block; }
        .user-category-title {
            font-size: 0.9em; font-weight: 700;
            text-transform: uppercase;
            color: color-mix(in srgb, var(--text-color) 90%, black 10%);
            margin-top: 20px; margin-bottom: 10px;
            cursor: pointer; user-select: none;
            position: relative; padding-left: 20px;
            transition: color 0.2s ease;
        }
        body.theme-pink .user-category-title {
            font-size: 1em;
            color: var(--text-color);
            text-shadow: 1px 1px 0px color-mix(in srgb, var(--primary-bg-color) 40%, transparent);
        }
        .user-category-title:hover { color: var(--accent-color); }
        .sidebar #user-list-container > .user-category-title:first-of-type { margin-top: -10px; }
        .user-category-title::before {
            content: 'â–¶';
            position: absolute; left: 0; top: 50%;
            transform: translateY(-50%);
            transition: transform 0.2s ease;
            font-size: 0.8em;
        }
        .user-category-title.active::before { transform: translateY(-50%) rotate(90deg); }
        .role-member-list {
            display: none; flex-direction: column; gap: 12px;
            padding-left: 5px;
        }
        .role-member-list.active { display: flex; }

        .user-item {
            display: flex; align-items: center; gap: 12px;
            padding: 10px 15px;
            background-color: color-mix(in srgb, var(--primary-bg-color) 70%, var(--secondary-bg-color) 30%);
            border-radius: 15px;
            border: 2px solid var(--border-color);
            transition: all 0.2s ease-in-out;
        }
        body.theme-neon .user-item {
             border-radius: 5px;
             border-left: 3px solid var(--accent-color);
             border-top: 1px solid var(--border-color);
             border-right: 1px solid var(--border-color);
             border-bottom: 1px solid var(--border-color);
        }
        body.theme-pink .user-item {
            box-shadow: 0 2px 5px var(--glow-color);
            background: linear-gradient(135deg, 
                color-mix(in srgb, var(--secondary-bg-color) 90%, var(--primary-bg-color) 10%), 
                color-mix(in srgb, var(--secondary-bg-color) 60%, var(--primary-bg-color) 40%)
            );
        }
        .user-pfp {
            width: 40px; height: 40px; border-radius: 50%;
            border: 2px solid var(--accent-color); object-fit: cover;
        }
        .username { font-weight: 600; font-size: 1em; color: var(--text-color); }
        
        .content-section p { margin-bottom: 15px; }

        @media (max-width: 900px) {
            .header-controls-container {
                width: 100%; justify-content: center;
                margin-top: 10px; margin-left: 0;
            }
            .header-main-content { align-items: center; }
            .header-main-content .design-note { margin-left: 0; text-align: center; }
            .main-container { flex-direction: column; }
            .sidebar { flex: 1 1 auto; max-height: none; align-self:stretch; margin-bottom: 20px; }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>

    <header class="site-header">
         <div class="header-main-content">
            <div class="logo-title-container">
                <img src="assets/server-logo-placeholder.png" alt="Server Logo" class="server-logo">
                <h1>
                    <span class="title-word title-oc">OC</span>
                    <span class="title-word title-world">WORLD</span>
                    <span class="title-word title-discord">DISCORD</span>
                    <span class="title-word title-community">COMMUNITY</span>
                    <span class="title-word title-hub">HUB</span>
                </h1>
            </div>
            <p class="design-note">(A website for the members to hang around)</p>
        </div>
        <div class="header-controls-container">
            <div class="theme-controls">
                <button id="modeToggle" class="mode-toggle" title="Toggle Dark/Light Mode">ðŸŒ™</button>
                <span class="theme-label">Theme:</span>
                <button id="themeNeon">Neon</button>
                <button id="themePink">Pink</button>
            </div>
            <div class="site-header-actions">
                <a href="#" id="openChatWindow" class="chat-icon-link" title="Open Live Chat">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/><path d="M7 9h10v2H7zm0 3h7v2H7z"/></svg>
                    <span>Chat</span>
                </a>
            </div>
        </div>
    </header>

    <div class="marquee-container">
        <marquee>Welcome to the OC World Community Hub! Discover our talented members and their creations!</marquee>
    </div>

    <div class="main-container">
        <aside class="sidebar">
            <h2>Members</h2>
            <div id="user-list-container">
                <p>Connecting to the Hub's database...</p>
            </div>
        </aside>

        <main class="content-area">
            <section id="about-server" class="content-section">
                <h2>About OC World Discord Server</h2>
                <p>Welcome to the OC World Discord Community Hub! This is the central place to discover the incredible original characters (OCs), stories, artwork, and achievements of our talented members. Our Discord server is a vibrant community for creators and enthusiasts alike, fostering collaboration, inspiration, and a shared passion for creativity.</p>
            </section>
        </main>
    </div>
    
    <footer class="site-footer-bottom"><p>Â© 2025 OC World Hub. All rights reserved.</p></footer>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <!-- particles.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- THEME & PARTICLES SCRIPT ---
        const body = document.body;
        const modeToggleButton = document.getElementById('modeToggle');
        const themeNeonButton = document.getElementById('themeNeon');
        const themePinkButton = document.getElementById('themePink');
        const openChatButton = document.getElementById('openChatWindow');

        const defaultModesForThemes = { neon: 'dark', pink: 'light' };
        let currentTheme = localStorage.getItem('oc_theme') || 'neon';
        let currentMode = localStorage.getItem(`oc_mode_${currentTheme}`) || defaultModesForThemes[currentTheme];

        function applyThemeAndMode() {
            body.className = '';
            body.classList.add(`theme-${currentTheme}`, `mode-${currentMode}`);
            modeToggleButton.textContent = currentMode === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
            themeNeonButton.classList.toggle('active', currentTheme === 'neon');
            themePinkButton.classList.toggle('active', currentTheme === 'pink');

            const computedStyle = getComputedStyle(body);
            const particleColor = computedStyle.getPropertyValue('--particle-color').trim().replace(/"/g, '');
            const particleLineColor = computedStyle.getPropertyValue('--particle-line-color').trim().replace(/"/g, '');
            
            if (window.pJSDom && window.pJSDom[0]) {
                 window.pJSDom[0].pJS.fn.vendors.destroypJS();
            }
             particlesJS('particles-js', { particles: { number: { value: 70 }, color: { value: particleColor }, line_linked: { color: particleLineColor, opacity: 0.3 }, move: { speed: 1.5 } } });
        }
        
        modeToggleButton.addEventListener('click', () => {
            currentMode = currentMode === 'dark' ? 'light' : 'dark';
            localStorage.setItem(`oc_mode_${currentTheme}`, currentMode);
            applyThemeAndMode();
        });
        themeNeonButton.addEventListener('click', () => {
            currentTheme = 'neon';
            currentMode = localStorage.getItem('oc_mode_neon') || defaultModesForThemes.neon;
            localStorage.setItem('oc_theme', currentTheme);
            applyThemeAndMode();
        });
        themePinkButton.addEventListener('click', () => {
            currentTheme = 'pink';
            currentMode = localStorage.getItem('oc_mode_pink') || defaultModesForThemes.pink;
            localStorage.setItem('oc_theme', currentTheme);
            applyThemeAndMode();
        });
        
        if (openChatButton) {
            openChatButton.addEventListener('click', function(event) {
                event.preventDefault();
                const chatUrl = `chat.html?theme=${currentTheme}&mode=${currentMode}`;
                window.open(chatUrl, 'ocWorldChat', 'width=500,height=650,resizable=yes,scrollbars=yes');
            });
        }
        
        applyThemeAndMode();

        // --- FIREBASE & MEMBER LIST SCRIPT ---
        const firebaseConfig = {
            apiKey: "AIzaSyBALj_xmS1OkTpH72oUzavFcyMyxm9MUrw",
            authDomain: "oc-world-hub-auto-users-add.firebaseapp.com",
            databaseURL: "https://oc-world-hub-auto-users-add-default-rtdb.firebaseio.com",
            projectId: "oc-world-hub-auto-users-add",
            storageBucket: "oc-world-hub-auto-users-add.firebasestorage.app",
            messagingSenderId: "507194352454",
            appId: "1:507194352454:web:24b2365cf356b237103b47",
            measurementId: "G-Q2NWRTPE6Y"
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const usersRef = database.ref('users');

        const userListContainer = document.getElementById('user-list-container');
        
        function renderUserList(users) {
            userListContainer.innerHTML = '';
            if (!users) { userListContainer.innerHTML = '<p>No members found in database. Please run the sync bot.</p>'; return; }

            const categoryRoles = ['Community Hub Website creator', 'Retired Staff', 'Member', '18+', '18-', 'Asia', 'America', 'Africa', 'Europe', 'Australia', 'No Roles'];
            const allUsersArray = Object.values(users);
            let isFirstCategory = true;
            
            categoryRoles.forEach(roleName => {
                let membersInCategory = [];
                if (roleName === 'No Roles') {
                    membersInCategory = allUsersArray.filter(user => !user.roles || user.roles.length === 0);
                } else {
                    membersInCategory = allUsersArray.filter(user => user.roles && user.roles.includes(roleName));
                }

                if (membersInCategory.length > 0) {
                    createCategory(roleName, membersInCategory, isFirstCategory);
                    isFirstCategory = false; // Only the very first category with members will be expanded
                }
            });
        }

        function createCategory(roleName, members, isFirst) {
            members.sort((a, b) => a.username.localeCompare(b.username));
            const categoryTitle = document.createElement('h3');
            categoryTitle.className = 'user-category-title';
            categoryTitle.textContent = `${roleName} (${members.length})`;
            userListContainer.appendChild(categoryTitle);

            const memberListDiv = document.createElement('div');
            memberListDiv.className = 'role-member-list';
            if(isFirst) {
                categoryTitle.classList.add('active');
                memberListDiv.classList.add('active');
            }
            userListContainer.appendChild(memberListDiv);
            
            members.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                const userPfp = document.createElement('img');
                userPfp.src = user.avatarURL;
                userPfp.alt = `${user.username}'s PFP`;
                userPfp.className = 'user-pfp';
                userPfp.onerror = function() { this.src = 'assets/server-logo-placeholder.png'; };
                const username = document.createElement('span');
                username.className = 'username';
                username.textContent = user.username;
                userItem.appendChild(userPfp);
                userItem.appendChild(username);
                memberListDiv.appendChild(userItem);
            });
        }
        
        userListContainer.addEventListener('click', function(event) {
            if (event.target.classList.contains('user-category-title')) {
                const title = event.target;
                const memberList = title.nextElementSibling;
                title.classList.toggle('active');
                if (memberList) memberList.classList.toggle('active');
            }
        });

        usersRef.on('value', (snapshot) => { renderUserList(snapshot.val()); }, (error) => {
             console.error("Firebase read failed: " + error.code);
             userListContainer.innerHTML = '<p>Error connecting to database.</p>';
        });
    });
    </script>
</body>
</html>
